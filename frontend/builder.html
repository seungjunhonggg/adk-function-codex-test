<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>에이전트 워크플로우 빌더</title>
    <link rel="stylesheet" href="/static/builder.css" />
  </head>
  <body>
    <div class="builder">
      <main class="canvas-wrap">
        <div class="canvas-toolbar">
          <button id="save-workflow" type="button">저장 및 적용</button>
          <button id="export-json" type="button">JSON 내보내기</button>
          <button id="toggle-all-nodes" type="button" class="ghost">전체 접기</button>
        </div>
        <div id="canvas" class="canvas">
          <svg id="connections" class="connections"></svg>
        </div>
        <aside class="palette">
          <div class="palette-header">
            <h1>워크플로우 빌더</h1>
          </div>
          <div id="palette-list" class="palette-list"></div>
          <div class="palette-footer">
            <button id="load-sample" type="button">샘플 플로우 불러오기</button>
            <button id="clear-canvas" type="button" class="ghost">전체 삭제</button>
            <a class="ghost" href="/" target="_blank" rel="noopener">메인 데모로 돌아가기</a>
          </div>
        </aside>
        <aside id="inspector-panel" class="inspector-panel">
          <div class="inspector-header">
            <div>
              <h3>설정 패널</h3>
              <p>노드를 선택하면 오른쪽에 설정 창이 나타납니다.</p>
            </div>
            <button id="inspector-close" type="button" class="ghost">닫기</button>
          </div>
          <div class="inspector-tabs">
            <button class="inspector-tab active" data-tab="node" type="button">노드</button>
            <button class="inspector-tab" data-tab="db" type="button">DB</button>
          </div>
          <div class="panel" data-panel="node">
            <h3>노드 설정</h3>
            <div id="node-empty" class="empty-state">노드를 선택하면 상세 설정이 표시됩니다.</div>
            <div id="node-form" class="node-form hidden">
              <div class="field">
                <label>선택된 노드 ID</label>
                <div id="node-id" class="mono">--</div>
              </div>
              <div class="field">
                <label for="node-label">라벨</label>
                <input id="node-label" type="text" />
              </div>
              <div class="field">
                <label for="node-type">타입</label>
                <input id="node-type" type="text" readonly />
              </div>
              <div class="field" id="node-execution-field">
                <label for="node-execution">실행 방식</label>
                <select id="node-execution">
                  <option value="handoff">handoff (인계)</option>
                  <option value="as_tool">as_tool (부하 에이전트)</option>
                </select>
              </div>
              <div id="node-fields"></div>
              <div class="panel-actions">
                <button id="node-delete" type="button" class="ghost danger">노드 삭제</button>
              </div>
            </div>
          </div>
        <div class="panel" data-panel="db">
          <h3>DB 연결</h3>
          <div class="field">
            <label for="db-name">연결 이름</label>
            <input id="db-name" type="text" placeholder="예: prod-postgres" />
          </div>
          <div class="field">
            <label for="db-type">DB 종류</label>
            <select id="db-type">
              <option value="postgresql">PostgreSQL</option>
            </select>
          </div>
          <div class="field">
            <label for="db-host">Host</label>
            <input id="db-host" type="text" placeholder="localhost" />
          </div>
          <div class="field">
            <label for="db-port">Port</label>
            <input id="db-port" type="number" value="5432" />
          </div>
          <div class="field">
            <label for="db-database">Database</label>
            <input id="db-database" type="text" placeholder="database" />
          </div>
          <div class="field">
            <label for="db-user">User</label>
            <input id="db-user" type="text" placeholder="username" />
          </div>
          <div class="field">
            <label for="db-password">Password</label>
            <input id="db-password" type="password" placeholder="password" />
          </div>
          <div class="panel-actions">
            <button id="db-connect" type="button">연결 & 스키마 불러오기</button>
            <button id="db-refresh" type="button" class="ghost">연결 목록 새로고침</button>
          </div>
          <div id="db-status" class="status">DB 연결 상태: 대기 중</div>
          <div id="db-connections" class="status"></div>
        </div>
        </aside>
        <div class="hidden">
          <input id="workflow-name" type="text" />
          <textarea id="workflow-desc"></textarea>
          <button id="load-workflow" type="button">서버에서 불러오기</button>
          <div id="workflow-status" class="status">저장 상태: 대기 중</div>
          <textarea id="flow-json" readonly></textarea>
          <button id="copy-json" type="button">복사</button>
        </div>
      </main>
    </div>

    <script src="/static/builder.js"></script>
  </body>
</html>
